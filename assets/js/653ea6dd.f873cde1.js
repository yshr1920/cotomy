"use strict";(globalThis.webpackChunkreference_site=globalThis.webpackChunkreference_site||[]).push([[6093],{2438(e,n,r){r.r(n),r.d(n,{assets:()=>a,contentTitle:()=>s,default:()=>h,frontMatter:()=>i,metadata:()=>o,toc:()=>c});const o=JSON.parse('{"id":"reference/getting-started/page-control","title":"Page Control","description":"CotomyPageController coordinates page-level behavior.","source":"@site/docs/reference/getting-started/07-page-control.md","sourceDirName":"reference/getting-started","slug":"/reference/getting-started/page-control","permalink":"/cotomy/reference/getting-started/page-control","draft":false,"unlisted":false,"tags":[],"version":"current","sidebarPosition":7,"frontMatter":{"title":"Page Control","sidebar_position":7},"sidebar":"tutorialSidebar","previous":{"title":"Ajax Form","permalink":"/cotomy/reference/getting-started/ajax-form"},"next":{"title":"Debugging and Tips","permalink":"/cotomy/reference/getting-started/debugging-and-tips"}}');var t=r(4848),l=r(8453);const i={title:"Page Control",sidebar_position:7},s="Page Control",a={},c=[{value:"Goals",id:"goals",level:2},{value:"Related Classes",id:"related-classes",level:2},{value:"Why a Page Controller?",id:"why-a-page-controller",level:2},{value:"CotomyWindow in This Layer",id:"cotomywindow-in-this-layer",level:2},{value:"Page vs Form Responsibilities",id:"page-vs-form-responsibilities",level:2},{value:"Steps",id:"steps",level:2},{value:"1) Create a page controller",id:"1-create-a-page-controller",level:3},{value:"2) Register forms",id:"2-register-forms",level:3},{value:"3) Access registered forms",id:"3-access-registered-forms",level:3},{value:"4) Restore after page show",id:"4-restore-after-page-show",level:3},{value:"5) URL handling",id:"5-url-handling",level:3},{value:"6) Lifecycle flow",id:"6-lifecycle-flow",level:3},{value:"Important Concept: One Controller per Page",id:"important-concept-one-controller-per-page",level:2},{value:"CotomyPageController does not:",id:"cotomypagecontroller-does-not",level:3},{value:"What just happened?",id:"what-just-happened",level:2},{value:"Next",id:"next",level:2}];function d(e){const n={a:"a",br:"br",code:"code",h1:"h1",h2:"h2",h3:"h3",header:"header",li:"li",mermaid:"mermaid",ol:"ol",p:"p",pre:"pre",table:"table",tbody:"tbody",td:"td",th:"th",thead:"thead",tr:"tr",ul:"ul",...(0,l.R)(),...e.components};return(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)(n.header,{children:(0,t.jsx)(n.h1,{id:"page-control",children:"Page Control"})}),"\n",(0,t.jsxs)(n.p,{children:[(0,t.jsx)(n.code,{children:"CotomyPageController"})," coordinates page-level behavior."]}),"\n",(0,t.jsx)(n.p,{children:"It is the entry point layer for a page."}),"\n",(0,t.jsx)(n.p,{children:"It manages:"}),"\n",(0,t.jsxs)(n.ul,{children:["\n",(0,t.jsx)(n.li,{children:"Page initialization"}),"\n",(0,t.jsx)(n.li,{children:"Form registration"}),"\n",(0,t.jsx)(n.li,{children:"Page restore after navigation"}),"\n",(0,t.jsx)(n.li,{children:"URL handling"}),"\n"]}),"\n",(0,t.jsxs)(n.p,{children:["Cotomy keeps logic page-scoped. There is no global application state shared\nacross pages.",(0,t.jsx)(n.br,{}),"\n","The page controller coordinates behavior but does not replace element-level UI\nlogic."]}),"\n",(0,t.jsx)(n.p,{children:"The controller coordinates behavior but does not hold UI state."}),"\n",(0,t.jsx)(n.h2,{id:"goals",children:"Goals"}),"\n",(0,t.jsxs)(n.ul,{children:["\n",(0,t.jsx)(n.li,{children:"Initialize page logic in one place"}),"\n",(0,t.jsx)(n.li,{children:"Manage multiple forms"}),"\n",(0,t.jsx)(n.li,{children:"Handle page lifecycle events"}),"\n"]}),"\n",(0,t.jsx)(n.h2,{id:"related-classes",children:"Related Classes"}),"\n",(0,t.jsx)(n.mermaid,{value:"classDiagram\nclass CotomyPageController\nclass CotomyWindow\nclass CotomyForm\nclass CotomyUrl\n\nCotomyPageController ..> CotomyWindow : lifecycle\nCotomyPageController o-- CotomyForm : manages\nCotomyPageController ..> CotomyUrl : reads"}),"\n",(0,t.jsx)(n.h2,{id:"why-a-page-controller",children:"Why a Page Controller?"}),"\n",(0,t.jsxs)(n.p,{children:["Cotomy is page-oriented. Each page is an independent UI module.\n",(0,t.jsx)(n.code,{children:"CotomyPageController"})," provides a single place to:"]}),"\n",(0,t.jsxs)(n.ul,{children:["\n",(0,t.jsx)(n.li,{children:"Initialize page-level logic"}),"\n",(0,t.jsx)(n.li,{children:"Register forms"}),"\n",(0,t.jsx)(n.li,{children:"Handle page lifecycle events"}),"\n"]}),"\n",(0,t.jsx)(n.p,{children:"Without it, page logic becomes scattered across elements and scripts."}),"\n",(0,t.jsx)(n.p,{children:"This is not a client-side router model. It targets document-driven business\nscreens where page scope keeps behavior predictable."}),"\n",(0,t.jsx)(n.p,{children:"Think of the page controller as the orchestrator for a single screen."}),"\n",(0,t.jsx)(n.h2,{id:"cotomywindow-in-this-layer",children:"CotomyWindow in This Layer"}),"\n",(0,t.jsxs)(n.p,{children:[(0,t.jsx)(n.code,{children:"CotomyWindow"})," is the runtime surface that exposes page-level lifecycle events\nto controllers. It handles:"]}),"\n",(0,t.jsxs)(n.ul,{children:["\n",(0,t.jsx)(n.li,{children:"Initial load and ready timing"}),"\n",(0,t.jsx)(n.li,{children:"Page restore detection (bfcache)"}),"\n",(0,t.jsx)(n.li,{children:"Global page events used by forms and controllers"}),"\n"]}),"\n",(0,t.jsxs)(n.p,{children:[(0,t.jsx)(n.code,{children:"CotomyPageController"})," runs on top of ",(0,t.jsx)(n.code,{children:"CotomyWindow"})," to keep page logic\npredictable without introducing a global app container."]}),"\n",(0,t.jsx)(n.h2,{id:"page-vs-form-responsibilities",children:"Page vs Form Responsibilities"}),"\n",(0,t.jsxs)(n.table,{children:[(0,t.jsx)(n.thead,{children:(0,t.jsxs)(n.tr,{children:[(0,t.jsx)(n.th,{children:"PageController"}),(0,t.jsx)(n.th,{children:"Form"})]})}),(0,t.jsxs)(n.tbody,{children:[(0,t.jsxs)(n.tr,{children:[(0,t.jsx)(n.td,{children:"Page initialization"}),(0,t.jsx)(n.td,{children:"Submit lifecycle"})]}),(0,t.jsxs)(n.tr,{children:[(0,t.jsx)(n.td,{children:"Form registration"}),(0,t.jsx)(n.td,{children:"API communication"})]}),(0,t.jsxs)(n.tr,{children:[(0,t.jsx)(n.td,{children:"Restore after navigation"}),(0,t.jsx)(n.td,{children:"Data load and rendering"})]}),(0,t.jsxs)(n.tr,{children:[(0,t.jsx)(n.td,{children:"URL access"}),(0,t.jsx)(n.td,{children:"Input and UI state"})]})]})]}),"\n",(0,t.jsx)(n.h2,{id:"steps",children:"Steps"}),"\n",(0,t.jsx)(n.h3,{id:"1-create-a-page-controller",children:"1) Create a page controller"}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-ts",children:'import { CotomyPageController } from "cotomy";\n\nCotomyPageController.set(class extends CotomyPageController {\n\tprotected override async initializeAsync(): Promise<void> {\n\t\tconsole.log("Page initialized");\n\t}\n});\n'})}),"\n",(0,t.jsxs)(n.p,{children:[(0,t.jsx)(n.code,{children:"set()"})," should be called once per page entry. The controller initializes when\nthe page loads."]}),"\n",(0,t.jsx)(n.h3,{id:"2-register-forms",children:"2) Register forms"}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-ts",children:'import { CotomyEntityFillApiForm, CotomyPageController } from "cotomy";\n\nCotomyPageController.set(class extends CotomyPageController {\n\tprotected override async initializeAsync(): Promise<void> {\n\t\tthis.setForm(CotomyEntityFillApiForm.byId<CotomyEntityFillApiForm>(\n\t\t\t"profile-form",\n\t\t\tclass extends CotomyEntityFillApiForm {}\n\t\t)!);\n\t}\n});\n'})}),"\n",(0,t.jsxs)(n.p,{children:[(0,t.jsx)(n.code,{children:"setForm()"})," registers the form with the page controller. If the form element is\nremoved, it is automatically unregistered.",(0,t.jsx)(n.br,{}),"\n",(0,t.jsx)(n.code,{children:"setForm()"})," also calls ",(0,t.jsx)(n.code,{children:"initialize()"})," on the form."]}),"\n",(0,t.jsx)(n.h3,{id:"3-access-registered-forms",children:"3) Access registered forms"}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-ts",children:'const form = this.getForm<CotomyEntityFillApiForm>("profile-form");\n'})}),"\n",(0,t.jsxs)(n.p,{children:["This is intended to be called inside a ",(0,t.jsx)(n.code,{children:"CotomyPageController"})," subclass method\nsuch as ",(0,t.jsx)(n.code,{children:"initializeAsync()"}),"."]}),"\n",(0,t.jsx)(n.h3,{id:"4-restore-after-page-show",children:"4) Restore after page show"}),"\n",(0,t.jsxs)(n.p,{children:["When a page is restored from browser cache (back/forward navigation), forms\nwith ",(0,t.jsx)(n.code,{children:"autoReload"})," enabled reload their data.",(0,t.jsx)(n.br,{}),"\n","Restore runs only when the browser uses bfcache. This can vary by browser and\npage settings, so it may not always fire."]}),"\n",(0,t.jsx)(n.h3,{id:"5-url-handling",children:"5) URL handling"}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-ts",children:'const url = this.url;\nconsole.log(url.path);\nconsole.log(url.parameters["id"]);\n'})}),"\n",(0,t.jsxs)(n.p,{children:[(0,t.jsx)(n.code,{children:"CotomyUrl"})," is mainly for reading the current URL state. Use it to drive page\ninitialization, such as loading data by ",(0,t.jsx)(n.code,{children:"id"})," from query parameters."]}),"\n",(0,t.jsx)(n.h3,{id:"6-lifecycle-flow",children:"6) Lifecycle flow"}),"\n",(0,t.jsx)(n.p,{children:"Page load sequence:"}),"\n",(0,t.jsxs)(n.ol,{children:["\n",(0,t.jsxs)(n.li,{children:[(0,t.jsx)(n.code,{children:"CotomyPageController.set()"})," is called"]}),"\n",(0,t.jsxs)(n.li,{children:[(0,t.jsx)(n.code,{children:"CotomyWindow"})," initializes"]}),"\n",(0,t.jsxs)(n.li,{children:[(0,t.jsx)(n.code,{children:"initializeAsync()"})," runs"]}),"\n",(0,t.jsx)(n.li,{children:"Forms are registered"}),"\n",(0,t.jsxs)(n.li,{children:[(0,t.jsx)(n.code,{children:"cotomy:ready"})," fires"]}),"\n"]}),"\n",(0,t.jsxs)(n.p,{children:[(0,t.jsx)(n.code,{children:"initializeAsync()"})," runs once on page load. ",(0,t.jsx)(n.code,{children:"restoreAsync()"})," runs when the page\nis restored from browser history."]}),"\n",(0,t.jsx)(n.p,{children:"Restore logic affects registered forms, not arbitrary elements."}),"\n",(0,t.jsxs)(n.p,{children:[(0,t.jsx)(n.code,{children:"cotomy:ready"})," is fired after page initialization completes and forms are\nregistered."]}),"\n",(0,t.jsxs)(n.p,{children:[(0,t.jsx)(n.code,{children:"CotomyPageController"})," works on top of ",(0,t.jsx)(n.code,{children:"CotomyWindow"}),", which handles low-level\npage events."]}),"\n",(0,t.jsx)(n.h2,{id:"important-concept-one-controller-per-page",children:"Important Concept: One Controller per Page"}),"\n",(0,t.jsx)(n.p,{children:"Cotomy assumes one page controller per page entry. It keeps page logic isolated\nand avoids cross-page state."}),"\n",(0,t.jsx)(n.h3,{id:"cotomypagecontroller-does-not",children:"CotomyPageController does not:"}),"\n",(0,t.jsxs)(n.ul,{children:["\n",(0,t.jsx)(n.li,{children:"Manage global application state"}),"\n",(0,t.jsx)(n.li,{children:"Share data between pages automatically"}),"\n",(0,t.jsx)(n.li,{children:"Implement client-side routing"}),"\n",(0,t.jsx)(n.li,{children:"Persist data between pages"}),"\n",(0,t.jsx)(n.li,{children:"Replace server-side navigation"}),"\n"]}),"\n",(0,t.jsx)(n.h2,{id:"what-just-happened",children:"What just happened?"}),"\n",(0,t.jsx)(n.p,{children:"You created a page-level controller that:"}),"\n",(0,t.jsxs)(n.ul,{children:["\n",(0,t.jsx)(n.li,{children:"Initializes page logic"}),"\n",(0,t.jsx)(n.li,{children:"Manages forms"}),"\n",(0,t.jsx)(n.li,{children:"Handles lifecycle events"}),"\n"]}),"\n",(0,t.jsx)(n.h2,{id:"next",children:"Next"}),"\n",(0,t.jsxs)(n.p,{children:["Next: ",(0,t.jsx)(n.a,{href:"/cotomy/reference/getting-started/debugging-and-tips",children:"Debugging and Tips"})," to troubleshoot effectively."]})]})}function h(e={}){const{wrapper:n}={...(0,l.R)(),...e.components};return n?(0,t.jsx)(n,{...e,children:(0,t.jsx)(d,{...e})}):d(e)}},8453(e,n,r){r.d(n,{R:()=>i,x:()=>s});var o=r(6540);const t={},l=o.createContext(t);function i(e){const n=o.useContext(l);return o.useMemo(function(){return"function"==typeof e?e(n):{...n,...e}},[n,e])}function s(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(t):e.components||t:i(e.components),o.createElement(l.Provider,{value:n},e.children)}}}]);